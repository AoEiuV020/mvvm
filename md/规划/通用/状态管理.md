# 状态管理

## ViewModel 状态设计

ViewModel 持有页面所需的全部状态，View 观察状态变化并更新 UI。

**状态分类：**

| 类型 | 说明 | 示例 |
|------|------|------|
| UI 状态 | 控制 UI 展示 | isLoading, errorMessage |
| 业务数据 | 业务实体 | user, messageList |
| 表单状态 | 用户输入 | phone, password |
| 派生状态 | 从其他状态计算 | isLoginEnabled |

## 状态更新原则

- 状态变更必须通过 ViewModel 方法
- View 不直接修改状态
- 派生状态自动计算，不手动维护

## 异步状态管理

异步操作（如网络请求）的状态管理：
1. 操作开始：设置 isLoading = true
2. 操作成功：更新业务数据，清除 loading
3. 操作失败：设置 errorMessage，清除 loading

## 状态持久化

需要跨会话保持的状态通过 SDK 持久化，ViewModel 启动时从 SDK 恢复。

## 禁止行为

- View 直接修改 ViewModel 内部状态
- 在 View 中维护业务状态
- 状态更新绕过 ViewModel
