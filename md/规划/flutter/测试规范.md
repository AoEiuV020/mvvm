# Flutter 测试规范

## ViewModel 单元测试

```dart
@GenerateMocks([IAuthService])
void main() {
  late MockIAuthService mockService;
  late XxxViewModel viewModel;
  
  setUp(() {
    mockService = MockIAuthService();
    viewModel = XxxViewModel(mockService);
  });
  
  test('xxx', () async {
    when(mockService.action()).thenAnswer((_) async => Result(success: true));
    
    final result = await viewModel.doAction();
    
    expect(result, true);
  });
}
```

## Widget 测试

```dart
testWidgets('xxx', (tester) async {
  await tester.pumpWidget(
    ProviderScope(
      overrides: [xxxProvider.overrideWith((ref) => MockXxx())],
      child: MaterialApp(home: XxxPage()),
    ),
  );
  
  expect(find.byType(XxxWidget), findsOneWidget);
});
```

## Mock 生成

使用 mockito，运行 `dart run build_runner build` 生成 mock 类。
