# Flutter 项目结构

## Workspace 多模块结构

基于[通用多模块结构](../通用/多模块结构.md)，Flutter 项目使用下划线命名：

```
flutter_im/
├── pubspec.yaml
├── packages/
│   ├── im_sdk_api/             # 公共接口和模型（sdk-api）
│   ├── im_sdk_tcp/             # TCP 长连接（sdk-tcp）
│   ├── im_sdk_http/            # HTTP 请求（sdk-http）
│   ├── im_sdk_db/              # 本地数据库（sdk-db）
│   ├── im_sdk/                 # 聚合模块（sdk）
│   ├── im_sdkui/               # 基础 UI SDK（sdkui）
│   ├── im_sdkui_group/         # 群组 UI（sdkui-group）
│   ├── im_sdkui_enterprise/    # 企业 UI（sdkui-enterprise）
│   └── im_uikit/               # 纯 UI 组件（uikit）
└── apps/
    └── im_app/                 # 主应用（app）
```

## 模块对应关系

| Flutter 模块 | 通用模块 |
|-------------|----------|
| `im_sdk_api` | sdk-api |
| `im_sdk_tcp` | sdk-tcp |
| `im_sdk_http` | sdk-http |
| `im_sdk_db` | sdk-db |
| `im_sdk` | sdk |
| `im_sdkui` | sdkui |
| `im_sdkui_group` | sdkui-group |
| `im_sdkui_enterprise` | sdkui-enterprise |
| `im_uikit` | uikit |
| `im_app` | app |

## 分层关系

```
          im_app
            ↓
     ┌──────┴──────┐
     ↓             ↓
  im_sdk    im_sdkui + im_sdkui_group + im_sdkui_enterprise
     ↓             ↓
im_sdk_tcp,im_sdk_http,im_sdk_db → im_sdk_api ← im_sdkui
                                        ↓
                                    im_uikit
```

## 文件命名规范

| 类型 | 命名格式 | 示例 |
|------|----------|------|
| ViewModel | `xxx_viewmodel.dart` | `login_viewmodel.dart` |
| State | `xxx_state.dart` | `login_state.dart` |
| View/Page | `xxx_page.dart` | `login_page.dart` |
| Widget | `xxx_widget.dart` | `message_bubble_widget.dart` |
| Validator | `xxx_validator.dart` | `login_validator.dart` |

## 模块内目录结构（按功能划分）

各模块内部按功能/页面组织，不按 MVVM 层划分。

### im_sdkui 示例

```
im_sdkui/lib/
├── login/                      # 登录功能
│   ├── login_page.dart         # View
│   ├── login_viewmodel.dart    # ViewModel
│   ├── login_state.dart        # State（freezed）
│   └── login_validator.dart    # Model（校验器）
├── sync/                       # 数据同步
│   ├── sync_page.dart
│   ├── sync_viewmodel.dart
│   └── sync_state.dart
├── conversation/               # 会话列表
│   ├── conversation_list_page.dart
│   ├── conversation_list_viewmodel.dart
│   ├── conversation_list_state.dart
│   └── widgets/                # 子组件
│       ├── conversation_item.dart
│       └── conversation_search.dart
├── chat/                       # 聊天页面
│   ├── chat_page.dart
│   ├── chat_viewmodel.dart
│   ├── chat_state.dart
│   └── widgets/
│       ├── message_list.dart
│       └── message_input.dart
└── providers/                  # 公共 Provider（SDK 依赖注入等）
    └── sdk_providers.dart
```

### im_app 示例

```
im_app/lib/
├── main.dart
├── router/
│   └── app_router.dart         # 路由配置
└── theme/
    └── app_theme.dart          # 主题配置
```
| Provider | `xxx_providers.dart` | `auth_providers.dart` |
| Model | `xxx_model.dart` | `user_model.dart` |
